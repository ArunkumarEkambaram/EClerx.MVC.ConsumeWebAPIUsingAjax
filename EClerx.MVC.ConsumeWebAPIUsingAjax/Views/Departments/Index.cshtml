
@{
    ViewBag.Title = "Index";
}

<h2>Display Departments using JQuery AJAX</h2>
<hr />
@Html.ActionLink("Add New", "Create", "Departments")
<div class="row">
    <div class="col-md-8">
        <table id="tblDepartment" class="table table-striped table-hover">
            <tr>
                <th>Department Code</th>
                <th>Department Name</th>
                <th>Department Head</th>
                <th>Location</th>
            </tr>
        </table>
    </div>
</div>

@section Scripts{
    <script>

        $(document).ready(function () {
            //Using JQuery AJAX
            //$.ajax({
            //    url: "http://localhost:50269/api/Departments/GetAll",
            //    type: "GET",
            //    dataType: "json",
            //    contentType: "application/json",
            //    success: function (data) {
            //        var tbl = '';
            //        $.each(data, function (key, item) {
            //            tbl += "<tr>";
            //            tbl += "<td>" + item.cDepartmentCode + "</td>";
            //            tbl += "<td>" + item.vDepartmentName + "</td>";
            //            tbl += "<td>" + item.vDepartmentHead + "</td>";
            //            tbl += "<td>" + item.vLocation + "</td>";
            //            tbl += "</tr>";
            //        });
            //        $(tbl).appendTo($("#tblDepartment"));
            //    },
            //    error: function (err) {
            //        console.log(err);
            //    }
            //});

            //JQuery JSON
            $.getJSON("http://localhost:50269/api/Departments/GetAll", function (data) {
                var tbl = '';
                $.each(data, function (key, item) {
                    tbl += "<tr>";
                    tbl += "<td>" + item.cDepartmentCode + "</td>";
                    tbl += "<td>" + item.vDepartmentName + "</td>";
                    tbl += "<td>" + item.vDepartmentHead + "</td>";
                    tbl += "<td>" + item.vLocation + "</td>";
                    tbl += "</tr>";
                });
                $(tbl).appendTo($("#tblDepartment"));
            });
        });
    </script>

}

